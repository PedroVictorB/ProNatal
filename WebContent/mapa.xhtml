<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html 
    xmlns="http://www.w3.org/1999/xhtml"   
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:body>
        <ui:composition template="templates/main.xhtml">
            <ui:param name="title" value="Home" />
            
            <ui:define name="resources">
                <script src="http://maps.googleapis.com/maps/api/js"></script>
            </ui:define>
            
            <ui:define name="content">	
                <div id="map" class="main-map"></div>

                <h:outputScript name="js/mainMap.js"/>
                
                <script>
                    var problems = JSON.parse('#{problemBean.retrieveAllProblems()}');
                    
                    //<![CDATA[
                    for(var i = 0; i < problems.length; i++) {
                        var problem = problems[i];
                        var latLng = new google.maps.LatLng(problem.marker.latitude,problem.marker.longitude);
                        var content = '<div class="container" style="max-width:300px;">' +
                                        '<div class="panel panel-default">' +
                                            '<div class="panel-heading">' +
                                                problem.title +
                                            '</div>' +
                                            '<div class="panel-body">' +
                                                problem.description +
                                            '</div>' +
                                        '</div>' +
                                      '</div>';
                        createMarker(latLng, content);
                    }
                    //]]>
                </script>
            </ui:define>
        </ui:composition>
    </h:body>
</html>	